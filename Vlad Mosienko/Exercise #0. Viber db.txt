Задача 0. Viber и подсчет времени офис-менеджера.

select sum(WastedTime), (TimeStamp/1000) / 300 
from
(
	select *,
		case when ContactID=1
		then (length(Body) - length(replace(Body, ' ', '')) + 1) / 0.6833
		else (length(Body) - length(replace(Body, ' ', '')) + 1) / 3.3333
		end as WastedTime
	from (
		select * 
		from MessageInfo 
		where datetime(TimeStamp/1000, 'unixepoch', 'localtime') > datetime(strftime('%s','now', '-1 day'), 'unixepoch', 'localtime'))
	
) group by (TimeStamp/1000) / 300


Описание: 
	выбираем сразу все сообщения за последние 24 часа. (Не хотело нормально выполнять сравнение пока 	было время было в unix-формате (так и не понял почему). Пришлость сначала перевести в нормальный 	вид потом сравнить. Поделил на 1000 потому что имея милисекунды в представлении функция datetime 	давала не правильный результат.) 
      Далее если сообщение отправили мы - считаем количество слов и делим на скорость набора слов(слов за сек), иначе если отправляли нам - делим на скорость чтения (слов за сек). 
      После этого группируем по 5 минут и находим суммы временных затрат отдельно для каждой группы.